---
phase: 02-foundation-types
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - src/types/market.ts
autonomous: true

must_haves:
  truths:
    - "Market type defines id, question, outcomes, probability, volume, endTime, status"
    - "Position type defines id, marketId, outcome, shares, costBasis, currentValue, pnl"
    - "Trade type defines marketId, outcome, type (buy/sell), shares, price, timestamp"
    - "TradeSlip type defines draft trade state before submission"
    - "Zustand and TanStack Query packages are installed"
  artifacts:
    - path: "src/types/market.ts"
      provides: "TypeScript types for prediction market domain"
      exports: ["Market", "MarketOutcome", "MarketStatus", "Position", "Trade", "TradeSlip", "OrderSide"]
    - path: "package.json"
      provides: "Updated dependencies"
      contains: "@tanstack/react-query"
  key_links:
    - from: "src/types/market.ts"
      to: "future stores and components"
      via: "type imports"
      pattern: "import.*from.*@/types/market"
---

<objective>
Install state management dependencies and establish TypeScript type definitions for prediction market domain.

Purpose: Create the foundational data contracts that all subsequent market, trading, and position components will use. Type-first development prevents integration churn later.

Output:
- @tanstack/react-query ^5.90.x and zustand ^5.0.x installed
- src/types/market.ts with Market, Position, Trade, TradeSlip types
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/SUMMARY.md

# Existing patterns to follow
@src/context/InfoContext.tsx
@src/hooks/useTelegram.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install state management dependencies</name>
  <files>package.json, package-lock.json</files>
  <action>
Install @tanstack/react-query and zustand:

```bash
npm install @tanstack/react-query@^5.90.0 zustand@^5.0.0
```

These versions are confirmed React 19 compatible per research.

Do NOT install @ton/ton or lightweight-charts yet - those are for later phases.
  </action>
  <verify>
Run `npm ls @tanstack/react-query zustand` - both packages should show installed versions.
Run `npm run build` - should complete without errors.
  </verify>
  <done>
- @tanstack/react-query ^5.90.x appears in package.json dependencies
- zustand ^5.0.x appears in package.json dependencies
- npm run build succeeds
  </done>
</task>

<task type="auto">
  <name>Task 2: Create prediction market type definitions</name>
  <files>src/types/market.ts</files>
  <action>
Create comprehensive TypeScript types for the prediction market domain.

File: `src/types/market.ts`

Types to define:

1. **MarketStatus** (enum-like union):
   - 'open' | 'closed' | 'resolved' | 'cancelled'

2. **MarketOutcome** (individual outcome in a market):
   - id: string
   - label: string (e.g., "Yes", "No", "Team A Wins")
   - probability: number (0-1, displayed as percentage)
   - totalShares: number

3. **Market** (prediction market):
   - id: string
   - question: string (the prediction question)
   - description?: string
   - category?: string
   - outcomes: MarketOutcome[]
   - volume: number (total traded volume)
   - liquidity: number
   - endTime: Date | string (ISO string for serialization)
   - resolvedOutcomeId?: string (set when market resolves)
   - status: MarketStatus
   - createdAt: Date | string
   - updatedAt: Date | string

4. **OrderSide** (trade direction):
   - 'buy' | 'sell'

5. **Trade** (executed trade):
   - id: string
   - marketId: string
   - outcomeId: string
   - side: OrderSide
   - shares: number
   - pricePerShare: number (0-1)
   - totalCost: number
   - timestamp: Date | string
   - txHash?: string (blockchain transaction hash)
   - status: 'pending' | 'confirmed' | 'failed'

6. **Position** (user's holdings in a market):
   - id: string
   - marketId: string
   - outcomeId: string
   - shares: number
   - avgCostBasis: number (average price paid per share)
   - currentPrice: number (current market price)
   - currentValue: number (shares * currentPrice)
   - unrealizedPnl: number (currentValue - (shares * avgCostBasis))
   - realizedPnl: number (from closed positions)

7. **TradeSlip** (draft trade before submission):
   - marketId: string
   - market?: Market (cached market data)
   - outcomeId: string
   - side: OrderSide
   - shares: number
   - estimatedCost: number
   - estimatedAvgPrice: number

Use trading vocabulary (position, shares, cost basis) not betting vocabulary (bet, stake, odds) per research constraints.

Export all types as named exports. Add JSDoc comments explaining each type's purpose.
  </action>
  <verify>
Run `npx tsc --noEmit` - should pass with no type errors.
Verify file exists at src/types/market.ts with `ls -la src/types/market.ts`.
  </verify>
  <done>
- src/types/market.ts exists
- All 7 types (MarketStatus, MarketOutcome, Market, OrderSide, Trade, Position, TradeSlip) are exported
- TypeScript compilation passes
- JSDoc comments explain each type's purpose
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. Dependencies installed:
```bash
npm ls @tanstack/react-query zustand
# Should show both packages with versions
```

2. Types compile:
```bash
npx tsc --noEmit
# Should pass with no errors
```

3. Build succeeds:
```bash
npm run build
# Should complete successfully
```

4. Types are importable (manual verification):
```typescript
// This should work in any component
import type { Market, Position, Trade, TradeSlip } from '@/types/market';
```
</verification>

<success_criteria>
- @tanstack/react-query ^5.90.x and zustand ^5.0.x installed
- src/types/market.ts exists with all required types
- TypeScript compilation passes
- Build succeeds
- Types use trading vocabulary, not betting vocabulary
</success_criteria>

<output>
After completion, create `.planning/phases/02-foundation-types/02-01-SUMMARY.md`
</output>
