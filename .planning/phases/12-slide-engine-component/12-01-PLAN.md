---
phase: 12-slide-engine-component
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/education/SlideEngine.tsx
  - src/components/education/SlideProgress.tsx
  - src/components/education/slides/IntroSlide.tsx
  - src/components/education/slides/ConceptSlide.tsx
  - src/components/education/slides/QuizSlide.tsx
  - src/components/education/slides/ActionSlide.tsx
  - src/components/education/slides/RewardSlide.tsx
autonomous: true

must_haves:
  truths:
    - "User can swipe left/right to navigate between slides"
    - "User can tap arrow buttons to navigate between slides"
    - "Each slide type renders its unique layout (intro, concept, quiz, action, reward)"
    - "Slide transitions animate smoothly with direction-aware enter/exit"
    - "Progress dots indicate current position in slide sequence"
  artifacts:
    - path: "src/components/education/SlideEngine.tsx"
      provides: "Main slide carousel with swipe gestures and arrow navigation"
      min_lines: 80
      contains: "AnimatePresence"
    - path: "src/components/education/SlideProgress.tsx"
      provides: "Dot indicator component showing current slide position"
      min_lines: 15
    - path: "src/components/education/slides/IntroSlide.tsx"
      provides: "Intro slide layout with title, body, optional mascot"
      exports: ["IntroSlideComponent"]
    - path: "src/components/education/slides/ConceptSlide.tsx"
      provides: "Concept slide layout with text and optional diagram"
      exports: ["ConceptSlideComponent"]
    - path: "src/components/education/slides/QuizSlide.tsx"
      provides: "Quiz slide with options, selection state, feedback display"
      exports: ["QuizSlideComponent"]
    - path: "src/components/education/slides/ActionSlide.tsx"
      provides: "Action slide with instruction and CTA button"
      exports: ["ActionSlideComponent"]
    - path: "src/components/education/slides/RewardSlide.tsx"
      provides: "Reward slide showing points and badge earned"
      exports: ["RewardSlideComponent"]
  key_links:
    - from: "src/components/education/SlideEngine.tsx"
      to: "src/lib/educationTypes.ts"
      via: "import Slide type"
      pattern: "import.*Slide.*from.*educationTypes"
    - from: "src/components/education/SlideEngine.tsx"
      to: "framer-motion"
      via: "AnimatePresence and motion.div with drag"
      pattern: "drag=\"x\""
    - from: "src/components/education/SlideEngine.tsx"
      to: "src/components/education/slides/*"
      via: "discriminated union switch rendering"
      pattern: "switch.*slide\\.type"
---

<objective>
Build the SlideEngine component with swipe/tap navigation and all 5 slide type renderers.

Purpose: This is the core UI component for education modules - users navigate through slides by swiping or tapping arrows, and each slide type (intro, concept, quiz, action, reward) renders with its appropriate layout.

Output: SlideEngine.tsx, SlideProgress.tsx, and 5 slide renderer components ready for Phase 12-02 to add haptic feedback and confetti.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-slide-engine-component/12-RESEARCH.md

# Phase 11 types (required import)
@src/lib/educationTypes.ts

# Existing patterns to follow
@src/components/ProgressionCard.tsx
@src/hooks/useTelegram.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SlideEngine with swipe and arrow navigation</name>
  <files>src/components/education/SlideEngine.tsx, src/components/education/SlideProgress.tsx</files>
  <action>
Create the main SlideEngine component using framer-motion's drag gesture for swipe detection:

**SlideEngine.tsx:**
- Props: `slides: Slide[]`, `onSlideChange?: (index: number) => void`, `onComplete?: () => void`
- State: `currentIndex` (number), `direction` (number for animation direction)
- Use `AnimatePresence` with `mode="wait"` and `custom={direction}` for direction-aware transitions
- Implement `motion.div` with `drag="x"`, `dragConstraints={{ left: 0, right: 0 }}`, `dragElastic={0.2}`
- Swipe detection in `onDragEnd`: threshold 50px offset OR 500px/s velocity
- Include prev/next arrow buttons (ChevronLeft/ChevronRight from lucide-react)
- Disable prev on first slide, disable next on last slide (for arrow buttons)
- On reaching last slide and swiping/clicking next, call `onComplete`
- Use slide variants from RESEARCH.md (X_OFFSET=300, ease=[0.32, 0.72, 0, 1])
- Add `touch-pan-y` class to allow vertical scroll while enabling horizontal swipe

**SlideProgress.tsx:**
- Props: `total: number`, `current: number`
- Render horizontal row of dots
- Current dot: larger (w-2.5 h-2.5), brighter (bg-white)
- Other dots: smaller (w-1.5 h-1.5), dimmer (bg-white/30)
- Use flex gap-2 for spacing

**DO NOT** add haptic feedback or confetti yet (that's Plan 12-02).

Pattern reference: See RESEARCH.md Pattern 1 (Framer Motion Drag) and Pattern 2 (Direction-Aware Slide Variants).
  </action>
  <verify>
File exists: `ls src/components/education/SlideEngine.tsx src/components/education/SlideProgress.tsx`
TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
SlideEngine renders slides with swipe gestures (drag="x"), arrow button navigation, and AnimatePresence transitions. SlideProgress shows dot indicators.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create all 5 slide type renderers</name>
  <files>
src/components/education/slides/IntroSlide.tsx
src/components/education/slides/ConceptSlide.tsx
src/components/education/slides/QuizSlide.tsx
src/components/education/slides/ActionSlide.tsx
src/components/education/slides/RewardSlide.tsx
  </files>
  <action>
Create individual slide renderer components for each slide type. Each component receives its typed slide as a prop and renders the appropriate layout.

**IntroSlide.tsx:**
- Props: slide from `IntroSlide` type
- Layout: Large title at top, body text centered, optional mascot image below
- Style: Title bold text-2xl, body text-white/70, mascot as centered image if present
- Cricket theme: Use warm amber/yellow accent colors consistent with app

**ConceptSlide.tsx:**
- Props: slide from `ConceptSlide` type
- Layout: Title at top, body text, optional diagram below
- Style: Similar to intro but body can be longer (educational content)
- If diagram exists, render as centered image with rounded corners

**QuizSlide.tsx:**
- Props: slide from `QuizSlide` type, onAnswer?: (isCorrect: boolean) => void
- State: `selectedOptionId` (string | null), `showResult` (boolean)
- Layout: Title, question text, option buttons in vertical stack
- Option button states:
  - Default: bg-white/10 border-white/20
  - Selected (before result): bg-amber-500/20 border-amber-500
  - Correct (after result): bg-green-500/20 border-green-500 with checkmark
  - Incorrect (after result): bg-red-500/20 border-red-500 with X
- Show explanation text below options after selection
- Call `onAnswer(isCorrect)` when user selects an option
- DO NOT add haptic/confetti here (Plan 12-02 will add that)

**ActionSlide.tsx:**
- Props: slide from `ActionSlide` type, onAction?: () => void
- Layout: Title, instruction text, prominent CTA button
- Button: Full-width, amber gradient background, buttonText from slide
- Call `onAction` when button clicked (actual wallet connect logic is Phase 13)

**RewardSlide.tsx:**
- Props: slide from `RewardSlide` type
- Layout: Celebration view with title, body, points display, badge display
- Style: Trophy icon (from lucide-react), points in large bold text
- Badge: Render badgeName with a badge-like styling (rounded pill, amber bg)

**All slides:**
- Use 'use client' directive
- Import types from `@/lib/educationTypes`
- Apply consistent padding (p-6), dark theme styling
- Title: text-xl font-bold text-white mb-4
  </action>
  <verify>
All files exist: `ls src/components/education/slides/`
TypeScript compiles: `npx tsc --noEmit`
Exports are valid: Each file exports a default component
  </verify>
  <done>
All 5 slide types render correctly: IntroSlide with mascot, ConceptSlide with diagram, QuizSlide with options and feedback states, ActionSlide with CTA button, RewardSlide with points/badge display.
  </done>
</task>

<task type="auto">
  <name>Task 3: Wire slide renderers into SlideEngine with discriminated union switch</name>
  <files>src/components/education/SlideEngine.tsx</files>
  <action>
Update SlideEngine to render the correct slide component based on slide type using TypeScript discriminated union pattern.

Add a `renderSlide` function inside SlideEngine that:
1. Takes a `Slide` (the union type)
2. Uses a switch statement on `slide.type`
3. Returns the appropriate component with typed props
4. Includes exhaustive check (`default: const _exhaustive: never = slide; return _exhaustive;`)

For QuizSlide, pass through the onAnswer callback that will be used by Phase 12-02:
```typescript
case 'quiz':
  return <QuizSlideComponent slide={slide} onAnswer={handleQuizAnswer} />;
```

Create a `handleQuizAnswer` function in SlideEngine that receives `isCorrect: boolean` - for now it can just log or be a no-op. Phase 12-02 will add haptics/confetti here.

Import all slide components from `./slides/` directory.

Pattern reference: See RESEARCH.md "Discriminated Union Slide Renderer" code example.
  </action>
  <verify>
TypeScript compiles with no errors: `npx tsc --noEmit`
Discriminated union is exhaustive (no TypeScript "not all code paths return" errors)
  </verify>
  <done>
SlideEngine renders the correct slide component for each type via discriminated union switch. QuizSlide receives onAnswer callback wired through SlideEngine.
  </done>
</task>

</tasks>

<verification>
1. All 7 files exist in src/components/education/
2. `npx tsc --noEmit` passes with no errors
3. SlideEngine exports a default component that accepts `slides: Slide[]`
4. All slide types are handled in the switch statement (exhaustive)
5. No framer-motion errors related to AnimatePresence or drag
</verification>

<success_criteria>
- SlideEngine component exists with swipe (drag="x") and arrow button navigation
- All 5 slide types render their unique layouts
- Progress dots show current position
- Transitions animate with direction awareness (enter from direction of swipe)
- TypeScript compiles without errors
- No runtime errors when rendering each slide type
</success_criteria>

<output>
After completion, create `.planning/phases/12-slide-engine-component/12-01-SUMMARY.md`
</output>
